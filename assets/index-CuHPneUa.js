(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&c(s)}).observe(document,{childList:!0,subtree:!0});function o(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(n){if(n.ep)return;n.ep=!0;const r=o(n);fetch(n.href,r)}})();let a=[];const f="HABIT_KEY";let u;const i={menu:document.querySelector(".menu__list"),header:{h1:document.querySelector(".h1"),progressPercent:document.querySelector(".progress__percent"),progressCoverBar:document.querySelector(".progress__coverBar")},content:{daysContainer:document.getElementById("days"),nextDay:document.querySelector(".habit__day"),form:document.querySelector(".habit__form")},popup:{index:document.getElementById("add-habit-popup"),iconField:document.querySelector(".popup__form input[name='icon']"),addHabitForm:document.querySelector(".popup__form")}};function h(){const t=localStorage.getItem(f),e=JSON.parse(t);a=Array.isArray(e)?e:[]}function p(){localStorage.setItem(f,JSON.stringify(a))}function m(){i.popup.index.classList.contains("cover_hidden")?i.popup.index.classList.remove("cover_hidden"):i.popup.index.classList.add("cover_hidden")}function y(t,e){for(const o of e)t[o].value="",t[o].classList.remove("error")}function g(t,e){const o=new FormData(t),c={};let n=!0;for(const r of e){const s=o.get(r);t[r].classList.remove("error"),s||(t[r].classList.add("error"),n=!1),c[r]=s}if(n)return c}function _(t){i.menu.innerHTML="";for(const e of a){const o=document.createElement("button");o.setAttribute("menu-habit-id",e.id),o.classList.add("menu__item"),o.innerHTML=` <img src="./src/assets/${e.icon}.svg" alt="${e.name}" >`,t.id===e.id&&o.classList.add("menu__item--active"),o.addEventListener("click",()=>d(e.id)),i.menu.appendChild(o)}}function L(t){i.header.h1.innerText=t.name;const e=t.days.length/t.target>1?100:t.days.length/t.target*100;i.header.progressPercent.innerText=e.toFixed(0)+"%",i.header.progressCoverBar.style.width=`${e}%`}function v(t){a=a.map(e=>e.id===u?(e.days.splice(t,1),{...e,days:e.days}):e),p(),d(u)}function E(t){i.content.daysContainer.innerHTML="",t.days.forEach((e,o)=>{const c=document.createElement("div");c.classList.add("habit");const n=document.createElement("div");n.classList.add("habit__day"),n.textContent=`Day ${o+1}`;const r=document.createElement("div");r.classList.add("habit__comment"),r.textContent=e.comment;const s=document.createElement("button");s.classList.add("habit__delete"),s.addEventListener("click",()=>v(o));const l=document.createElement("img");l.src="./src/assets/delete.svg",l.alt=`Delete day ${o+1}`,s.appendChild(l),c.appendChild(n),c.appendChild(r),c.appendChild(s),i.content.daysContainer.appendChild(c)}),i.content.nextDay.innerHTML=`Day ${t.days.length+1}`}function d(t){u=t;const e=a.find(o=>o.id===t);e&&(document.location.replace(document.location.pathname+"#"+t),_(e),L(e),E(e))}function b(t){t.preventDefault();const e=g(t.target,["comment"]);e&&(a=a.map(o=>o.id===u?{...o,days:o.days.concat([{comment:e.comment}])}:o),p(),d(u),y(t.target,["comment"]))}function S(t){t.preventDefault(),console.log("addHabit function called");const e=g(t.target,["name","icon","target"]);if(!e){console.log("Form validation failed");return}const c={id:a.reduce((n,r)=>n>r.id?n:r.id,0)+1,name:e.name,target:e.target,icon:e.icon,days:[]};a.push(c),p(),d(c.id),y(t.target,["name","target"]),m()}i.header.h1.addEventListener("click",()=>{});function C(t,e){i.popup.iconField.value=e,document.querySelector(".icon.icon_active").classList.remove("icon_active"),t.classList.add("icon_active")}(()=>{h();function t(){var n;if(a.length>0){const r=Number(document.location.hash.replace("#","")),s=a.find(l=>l.id===r);d(s?s.id:(n=a[0])==null?void 0:n.id)}}t(),i.content.form.addEventListener("submit",b),i.popup.addHabitForm.addEventListener("submit",S),document.querySelector(".menu__add").addEventListener("click",m),document.querySelectorAll(".icon").forEach(n=>{n.addEventListener("click",function(){const r=this.querySelector("img").getAttribute("alt").toLowerCase();C(this,r)})}),document.querySelector(".popup__close").addEventListener("click",m)})();
